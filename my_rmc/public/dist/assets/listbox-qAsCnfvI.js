import{K as V,U as he,V as Ee,y as H,a as Re,F as $e,o as m,W as Ie,X as ye,$ as Pe,d as Le,w as Te,_ as pe,e as Me,L as G,x as we,n as De,u as Ce,g as ke,i as J,m as _e,h as Fe,j as Ae,R as Be,f as Ne,p as fe,T as Qe,q as Ke,s as Ue,t as Ve,Y as He,v as se,A as Ge,B as je,Z as qe,N as K,E as ze,C as Je,M as Xe,J as We,O as de,c as R,r as Ze,b as y,k as Ye,l as ce,Q as re,S as et,H as tt,I as ot}from"./transition-BKURVBNq.js";import{a as c,R as D,a2 as B}from"./index-rEV4Vl1Z.js";import{l as nt,a as at,T as it,u as rt,j as lt,p as st}from"./frozen-uC-eRWVz.js";import{s as ut,a as dt}from"./use-text-value-CuK3Jh5V.js";var ct=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ct||{}),pt=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(pt||{}),ft=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(ft||{}),vt=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e[e.SetButtonElement=7]="SetButtonElement",e[e.SetOptionsElement=8]="SetOptionsElement",e))(vt||{});function le(e,n=i=>i){let i=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,t=et(n(e.options.slice()),x=>x.dataRef.current.domRef.current),a=i?t.indexOf(i):null;return a===-1&&(a=null),{options:t,activeOptionIndex:a}}let bt={1(e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1,__demoMode:!1}},0(e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let n=e.activeOptionIndex,{isSelected:i}=e.dataRef.current,t=e.options.findIndex(a=>i(a.dataRef.current.value));return t!==-1&&(n=t),{...e,listboxState:0,activeOptionIndex:n,__demoMode:!1}},2(e,n){var i,t,a,x,S;if(e.dataRef.current.disabled||e.listboxState===1)return e;let p={...e,searchQuery:"",activationTrigger:(i=n.trigger)!=null?i:1,__demoMode:!1};if(n.focus===R.Nothing)return{...p,activeOptionIndex:null};if(n.focus===R.Specific)return{...p,activeOptionIndex:e.options.findIndex(u=>u.id===n.id)};if(n.focus===R.Previous){let u=e.activeOptionIndex;if(u!==null){let d=e.options[u].dataRef.current.domRef,g=re(n,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});if(g!==null){let v=e.options[g].dataRef.current.domRef;if(((t=d.current)==null?void 0:t.previousElementSibling)===v.current||((a=v.current)==null?void 0:a.previousElementSibling)===null)return{...p,activeOptionIndex:g}}}}else if(n.focus===R.Next){let u=e.activeOptionIndex;if(u!==null){let d=e.options[u].dataRef.current.domRef,g=re(n,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});if(g!==null){let v=e.options[g].dataRef.current.domRef;if(((x=d.current)==null?void 0:x.nextElementSibling)===v.current||((S=v.current)==null?void 0:S.nextElementSibling)===null)return{...p,activeOptionIndex:g}}}}let s=le(e),O=re(n,{resolveItems:()=>s.options,resolveActiveIndex:()=>s.activeOptionIndex,resolveId:u=>u.id,resolveDisabled:u=>u.dataRef.current.disabled});return{...p,...s,activeOptionIndex:O}},3:(e,n)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let i=e.searchQuery!==""?0:1,t=e.searchQuery+n.value.toLowerCase(),a=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+i).concat(e.options.slice(0,e.activeOptionIndex+i)):e.options).find(S=>{var p;return!S.dataRef.current.disabled&&((p=S.dataRef.current.textValue)==null?void 0:p.startsWith(t))}),x=a?e.options.indexOf(a):-1;return x===-1||x===e.activeOptionIndex?{...e,searchQuery:t}:{...e,searchQuery:t,activeOptionIndex:x,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5:(e,n)=>{let i={id:n.id,dataRef:n.dataRef},t=le(e,a=>[...a,i]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(n.dataRef.current.value)&&(t.activeOptionIndex=t.options.indexOf(i)),{...e,...t}},6:(e,n)=>{let i=le(e,t=>{let a=t.findIndex(x=>x.id===n.id);return a!==-1&&t.splice(a,1),t});return{...e,...i,activationTrigger:1}},7:(e,n)=>e.buttonElement===n.element?e:{...e,buttonElement:n.element},8:(e,n)=>e.optionsElement===n.element?e:{...e,optionsElement:n.element}},ue=c.createContext(null);ue.displayName="ListboxActionsContext";function X(e){let n=c.useContext(ue);if(n===null){let i=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,X),i}return n}let W=c.createContext(null);W.displayName="ListboxDataContext";function j(e){let n=c.useContext(W);if(n===null){let i=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,j),i}return n}function xt(e,n){return K(n.type,bt,e,n)}let mt=c.Fragment;function Ot(e,n){var i;let t=qe(),{value:a,defaultValue:x,form:S,name:p,onChange:s,by:O,invalid:u=!1,disabled:d=t||!1,horizontal:g=!1,multiple:v=!1,__demoMode:o=!1,...h}=e;const A=g?"horizontal":"vertical";let k=H(n),P=at(x),[$=v?[]:void 0,L]=it(a,s,P),[w,E]=c.useReducer(xt,{dataRef:c.createRef(),listboxState:o?0:1,options:[],searchQuery:"",activeOptionIndex:null,activationTrigger:1,optionsVisible:!1,buttonElement:null,optionsElement:null,__demoMode:o}),_=c.useRef({static:!1,hold:!1}),F=c.useRef(new Map),b=rt(O),M=c.useCallback(f=>K(r.mode,{1:()=>$.some(I=>b(I,f)),0:()=>b($,f)}),[$]),r=c.useMemo(()=>({...w,value:$,disabled:d,invalid:u,mode:v?1:0,orientation:A,compare:b,isSelected:M,optionsPropsRef:_,listRef:F}),[$,d,u,v,w,F]);se(()=>{w.dataRef.current=r},[r]);let N=r.listboxState===0;ze(N,[r.buttonElement,r.optionsElement],(f,I)=>{var C;E({type:1}),tt(I,ot.Loose)||(f.preventDefault(),(C=r.buttonElement)==null||C.focus())});let Z=c.useMemo(()=>({open:r.listboxState===0,disabled:d,invalid:u,value:$}),[r,d,$,u]),Y=m(f=>{let I=r.options.find(C=>C.id===f);I&&U(I.dataRef.current.value)}),ee=m(()=>{if(r.activeOptionIndex!==null){let{dataRef:f,id:I}=r.options[r.activeOptionIndex];U(f.current.value),E({type:2,focus:R.Specific,id:I})}}),te=m(()=>E({type:0})),q=m(()=>E({type:1})),z=fe(),oe=m((f,I,C)=>{z.dispose(),z.microTask(()=>f===R.Specific?E({type:2,focus:R.Specific,id:I,trigger:C}):E({type:2,focus:f,trigger:C}))}),ne=m((f,I)=>(E({type:5,id:f,dataRef:I}),()=>E({type:6,id:f}))),U=m(f=>K(r.mode,{0(){return L==null?void 0:L(f)},1(){let I=r.value.slice(),C=I.findIndex(ge=>b(ge,f));return C===-1?I.push(f):I.splice(C,1),L==null?void 0:L(I)}})),ae=m(f=>E({type:3,value:f})),l=m(()=>E({type:4})),T=m(f=>{E({type:7,element:f})}),Q=m(f=>{E({type:8,element:f})}),ie=c.useMemo(()=>({onChange:U,registerOption:ne,goToOption:oe,closeListbox:q,openListbox:te,selectActiveOption:ee,selectOption:Y,search:ae,clearSearch:l,setButtonElement:T,setOptionsElement:Q}),[]),[be,xe]=Je({inherit:!0}),me={ref:k},Oe=c.useCallback(()=>{if(P!==void 0)return L==null?void 0:L(P)},[L,P]),Se=G();return D.createElement(xe,{value:be,props:{htmlFor:(i=r.buttonElement)==null?void 0:i.id},slot:{open:r.listboxState===0,disabled:d}},D.createElement(Xe,null,D.createElement(ue.Provider,{value:ie},D.createElement(W.Provider,{value:r},D.createElement(We,{value:K(r.listboxState,{0:J.Open,1:J.Closed})},p!=null&&$!=null&&D.createElement(lt,{disabled:d,data:{[p]:$},form:S,onReset:Oe}),Se({ourProps:me,theirProps:h,slot:Z,defaultTag:mt,name:"Listbox"}))))))}let St="button";function gt(e,n){var i;let t=j("Listbox.Button"),a=X("Listbox.Button"),x=c.useId(),S=Ee(),{id:p=S||`headlessui-listbox-button-${x}`,disabled:s=t.disabled||!1,autoFocus:O=!1,...u}=e,d=H(n,Re(),a.setButtonElement),g=$e(),v=m(r=>{switch(r.key){case y.Enter:st(r.currentTarget);break;case y.Space:case y.ArrowDown:r.preventDefault(),B.flushSync(()=>a.openListbox()),t.value||a.goToOption(R.First);break;case y.ArrowUp:r.preventDefault(),B.flushSync(()=>a.openListbox()),t.value||a.goToOption(R.Last);break}}),o=m(r=>{switch(r.key){case y.Space:r.preventDefault();break}}),h=m(r=>{var N;if(Ze(r.currentTarget))return r.preventDefault();t.listboxState===0?(B.flushSync(()=>a.closeListbox()),(N=t.buttonElement)==null||N.focus({preventScroll:!0})):(r.preventDefault(),a.openListbox())}),A=m(r=>r.preventDefault()),k=Ie([p]),P=ye(),{isFocusVisible:$,focusProps:L}=Pe({autoFocus:O}),{isHovered:w,hoverProps:E}=Le({isDisabled:s}),{pressed:_,pressProps:F}=Te({disabled:s}),b=c.useMemo(()=>({open:t.listboxState===0,active:_||t.listboxState===0,disabled:s,invalid:t.invalid,value:t.value,hover:w,focus:$,autofocus:O}),[t.listboxState,t.value,s,w,$,_,t.invalid,O]),M=pe(g(),{ref:d,id:p,type:Me(e,t.buttonElement),"aria-haspopup":"listbox","aria-controls":(i=t.optionsElement)==null?void 0:i.id,"aria-expanded":t.listboxState===0,"aria-labelledby":k,"aria-describedby":P,disabled:s||void 0,autoFocus:O,onKeyDown:v,onKeyUp:o,onKeyPress:A,onClick:h},L,E,F);return G()({ourProps:M,theirProps:u,slot:b,defaultTag:St,name:"Listbox.Button"})}let ve=c.createContext(!1),ht="div",Et=de.RenderStrategy|de.Static;function Rt(e,n){var i,t;let a=c.useId(),{id:x=`headlessui-listbox-options-${a}`,anchor:S,portal:p=!1,modal:s=!0,transition:O=!1,...u}=e,d=we(S),[g,v]=c.useState(null);d&&(p=!0);let o=j("Listbox.Options"),h=X("Listbox.Options"),A=De(o.optionsElement),k=Ce(),[P,$]=ke(O,g,k!==null?(k&J.Open)===J.Open:o.listboxState===0);_e(P,o.buttonElement,h.closeListbox);let L=o.__demoMode?!1:s&&o.listboxState===0;Fe(L,A);let w=o.__demoMode?!1:s&&o.listboxState===0;Ae(w,{allowed:c.useCallback(()=>[o.buttonElement,o.optionsElement],[o.buttonElement,o.optionsElement])});let E=o.listboxState!==0,_=ut(E,o.buttonElement)?!1:P,F=P&&o.listboxState===1,b=nt(F,o.value),M=m(l=>o.compare(b,l)),r=c.useMemo(()=>{var l;if(d==null||!((l=d==null?void 0:d.to)!=null&&l.includes("selection")))return null;let T=o.options.findIndex(Q=>M(Q.dataRef.current.value));return T===-1&&(T=0),T},[d,o.options]),N=(()=>{if(d==null)return;if(r===null)return{...d,inner:void 0};let l=Array.from(o.listRef.current.values());return{...d,inner:{listRef:{current:l},index:r}}})(),[Z,Y]=Be(N),ee=Ne(),te=H(n,d?Z:null,h.setOptionsElement,v),q=fe();c.useEffect(()=>{var l;let T=o.optionsElement;T&&o.listboxState===0&&T!==((l=Qe(T))==null?void 0:l.activeElement)&&(T==null||T.focus({preventScroll:!0}))},[o.listboxState,o.optionsElement]);let z=m(l=>{var T,Q;switch(q.dispose(),l.key){case y.Space:if(o.searchQuery!=="")return l.preventDefault(),l.stopPropagation(),h.search(l.key);case y.Enter:if(l.preventDefault(),l.stopPropagation(),o.activeOptionIndex!==null){let{dataRef:ie}=o.options[o.activeOptionIndex];h.onChange(ie.current.value)}o.mode===0&&(B.flushSync(()=>h.closeListbox()),(T=o.buttonElement)==null||T.focus({preventScroll:!0}));break;case K(o.orientation,{vertical:y.ArrowDown,horizontal:y.ArrowRight}):return l.preventDefault(),l.stopPropagation(),h.goToOption(R.Next);case K(o.orientation,{vertical:y.ArrowUp,horizontal:y.ArrowLeft}):return l.preventDefault(),l.stopPropagation(),h.goToOption(R.Previous);case y.Home:case y.PageUp:return l.preventDefault(),l.stopPropagation(),h.goToOption(R.First);case y.End:case y.PageDown:return l.preventDefault(),l.stopPropagation(),h.goToOption(R.Last);case y.Escape:l.preventDefault(),l.stopPropagation(),B.flushSync(()=>h.closeListbox()),(Q=o.buttonElement)==null||Q.focus({preventScroll:!0});return;case y.Tab:l.preventDefault(),l.stopPropagation(),B.flushSync(()=>h.closeListbox()),Ye(o.buttonElement,l.shiftKey?ce.Previous:ce.Next);break;default:l.key.length===1&&(h.search(l.key),q.setTimeout(()=>h.clearSearch(),350));break}}),oe=(i=o.buttonElement)==null?void 0:i.id,ne=c.useMemo(()=>({open:o.listboxState===0}),[o.listboxState]),U=pe(d?ee():{},{id:x,ref:te,"aria-activedescendant":o.activeOptionIndex===null||(t=o.options[o.activeOptionIndex])==null?void 0:t.id,"aria-multiselectable":o.mode===1?!0:void 0,"aria-labelledby":oe,"aria-orientation":o.orientation,onKeyDown:z,role:"listbox",tabIndex:o.listboxState===0?0:void 0,style:{...u.style,...Y,"--button-width":Ue(o.buttonElement,!0).width},...Ke($)}),ae=G();return D.createElement(Ve,{enabled:p?e.static||P:!1},D.createElement(W.Provider,{value:o.mode===1?o:{...o,isSelected:M}},ae({ourProps:U,theirProps:u,slot:ne,defaultTag:ht,features:Et,visible:_,name:"Listbox.Options"})))}let $t="div";function It(e,n){let i=c.useId(),{id:t=`headlessui-listbox-option-${i}`,disabled:a=!1,value:x,...S}=e,p=c.useContext(ve)===!0,s=j("Listbox.Option"),O=X("Listbox.Option"),u=s.activeOptionIndex!==null?s.options[s.activeOptionIndex].id===t:!1,d=s.isSelected(x),g=c.useRef(null),v=dt(g),o=He({disabled:a,value:x,domRef:g,get textValue(){return v()}}),h=H(n,g,b=>{b?s.listRef.current.set(t,b):s.listRef.current.delete(t)});se(()=>{if(!s.__demoMode&&s.listboxState===0&&u&&s.activationTrigger!==0)return Ge().requestAnimationFrame(()=>{var b,M;(M=(b=g.current)==null?void 0:b.scrollIntoView)==null||M.call(b,{block:"nearest"})})},[g,u,s.__demoMode,s.listboxState,s.activationTrigger,s.activeOptionIndex]),se(()=>{if(!p)return O.registerOption(t,o)},[o,t,p]);let A=m(b=>{var M;if(a)return b.preventDefault();O.onChange(x),s.mode===0&&(B.flushSync(()=>O.closeListbox()),(M=s.buttonElement)==null||M.focus({preventScroll:!0}))}),k=m(()=>{if(a)return O.goToOption(R.Nothing);O.goToOption(R.Specific,t)}),P=je(),$=m(b=>{P.update(b),!a&&(u||O.goToOption(R.Specific,t,0))}),L=m(b=>{P.wasMoved(b)&&(a||u||O.goToOption(R.Specific,t,0))}),w=m(b=>{P.wasMoved(b)&&(a||u&&O.goToOption(R.Nothing))}),E=c.useMemo(()=>({active:u,focus:u,selected:d,disabled:a,selectedOption:d&&p}),[u,d,a,p]),_=p?{}:{id:t,ref:h,role:"option",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,"aria-selected":d,disabled:void 0,onClick:A,onFocus:k,onPointerEnter:$,onMouseEnter:$,onPointerMove:L,onMouseMove:L,onPointerLeave:w,onMouseLeave:w},F=G();return!d&&p?null:F({ourProps:_,theirProps:S,slot:E,defaultTag:$t,name:"Listbox.Option"})}let yt=c.Fragment;function Pt(e,n){let{options:i,placeholder:t,...a}=e,x={ref:H(n)},S=j("ListboxSelectedOption"),p=c.useMemo(()=>({}),[]),s=S.value===void 0||S.value===null||S.mode===1&&Array.isArray(S.value)&&S.value.length===0,O=G();return D.createElement(ve.Provider,{value:!0},O({ourProps:x,theirProps:{...a,children:D.createElement(D.Fragment,null,t&&s?t:i)},slot:p,defaultTag:yt,name:"ListboxSelectedOption"}))}let Lt=V(Ot),Tt=V(gt),Mt=he,wt=V(Rt),Dt=V(It),Ct=V(Pt),Bt=Object.assign(Lt,{Button:Tt,Label:Mt,Options:wt,Option:Dt,SelectedOption:Ct});export{wt as G,Bt as M,Tt as N,Dt as V};
