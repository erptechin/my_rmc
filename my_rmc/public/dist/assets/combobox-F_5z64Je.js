import{o as E,K as le,V as Be,W as Ve,y as de,a as Ne,n as we,p as je,c as w,b as L,N as te,X as he,Y as We,$ as $e,d as Pe,_ as fe,L as re,r as Ue,w as Ke,e as He,x as Ge,R as qe,f as Qe,u as Je,g as Xe,i as ce,m as Ye,h as Ze,j as et,v as Q,q as tt,s as xe,t as nt,Z as ot,A as Ee,aj as it,B as st,a0 as lt,E as rt,C as at,M as ut,J as ct,O as Se,Q as Oe,S as dt}from"./transition-My9i7tYZ.js";import{a as f,Q as Y,R as k}from"./index-CGlN053l.js";import{l as Ie,b as pt,a as mt,T as ht,u as ft,j as bt}from"./frozen-BP7x9_Ny.js";import{E as vt,m as ye,r as Ce}from"./active-element-history-DqHQeAkz.js";import{F as gt}from"./Datepicker-BW9Fix3f.js";function ee(e,l,t){let n=t.initialDeps??[],o;function r(){var s,i,a,u;let d;t.key&&((s=t.debug)!=null&&s.call(t))&&(d=Date.now());const m=e();if(!(m.length!==n.length||m.some((O,x)=>n[x]!==O)))return o;n=m;let c;if(t.key&&((i=t.debug)!=null&&i.call(t))&&(c=Date.now()),o=l(...m),t.key&&((a=t.debug)!=null&&a.call(t))){const O=Math.round((Date.now()-d)*100)/100,x=Math.round((Date.now()-c)*100)/100,b=x/16,P=(T,$)=>{for(T=String(T);T.length<$;)T=" "+T;return T};console.info(`%câ± ${P(x,5)} /${P(O,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*b,120))}deg 100% 31%);`,t==null?void 0:t.key)}return(u=t==null?void 0:t.onChange)==null||u.call(t,o),o}return r.updateDeps=s=>{n=s},r}function pe(e,l){if(e===void 0)throw new Error("Unexpected undefined");return e}const xt=(e,l)=>Math.abs(e-l)<1,Et=(e,l,t)=>{let n;return function(...o){e.clearTimeout(n),n=e.setTimeout(()=>l.apply(this,o),t)}},St=e=>e,Ot=e=>{const l=Math.max(e.startIndex-e.overscan,0),t=Math.min(e.endIndex+e.overscan,e.count-1),n=[];for(let o=l;o<=t;o++)n.push(o);return n},It=(e,l)=>{const t=e.scrollElement;if(!t)return;const n=e.targetWindow;if(!n)return;const o=s=>{const{width:i,height:a}=s;l({width:Math.round(i),height:Math.round(a)})};if(o(t.getBoundingClientRect()),!n.ResizeObserver)return()=>{};const r=new n.ResizeObserver(s=>{const i=()=>{const a=s[0];if(a!=null&&a.borderBoxSize){const u=a.borderBoxSize[0];if(u){o({width:u.inlineSize,height:u.blockSize});return}}o(t.getBoundingClientRect())};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(i):i()});return r.observe(t,{box:"border-box"}),()=>{r.unobserve(t)}},Te={passive:!0},Re=typeof window>"u"?!0:"onscrollend"in window,yt=(e,l)=>{const t=e.scrollElement;if(!t)return;const n=e.targetWindow;if(!n)return;let o=0;const r=e.options.useScrollendEvent&&Re?()=>{}:Et(n,()=>{l(o,!1)},e.options.isScrollingResetDelay),s=d=>()=>{const{horizontal:m,isRtl:S}=e.options;o=m?t.scrollLeft*(S&&-1||1):t.scrollTop,r(),l(o,d)},i=s(!0),a=s(!1);a(),t.addEventListener("scroll",i,Te);const u=e.options.useScrollendEvent&&Re;return u&&t.addEventListener("scrollend",a,Te),()=>{t.removeEventListener("scroll",i),u&&t.removeEventListener("scrollend",a)}},Ct=(e,l,t)=>{if(l!=null&&l.borderBoxSize){const n=l.borderBoxSize[0];if(n)return Math.round(n[t.options.horizontal?"inlineSize":"blockSize"])}return Math.round(e.getBoundingClientRect()[t.options.horizontal?"width":"height"])},Tt=(e,{adjustments:l=0,behavior:t},n)=>{var o,r;const s=e+l;(r=(o=n.scrollElement)==null?void 0:o.scrollTo)==null||r.call(o,{[n.options.horizontal?"left":"top"]:s,behavior:t})};class Rt{constructor(l){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let t=null;const n=()=>t||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:t=new this.targetWindow.ResizeObserver(o=>{o.forEach(r=>{const s=()=>{this._measureElement(r.target,r)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(s):s()})}));return{disconnect:()=>{var o;(o=n())==null||o.disconnect(),t=null},observe:o=>{var r;return(r=n())==null?void 0:r.observe(o,{box:"border-box"})},unobserve:o=>{var r;return(r=n())==null?void 0:r.unobserve(o)}}})(),this.range=null,this.setOptions=t=>{Object.entries(t).forEach(([n,o])=>{typeof o>"u"&&delete t[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:St,rangeExtractor:Ot,onChange:()=>{},measureElement:Ct,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...t}},this.notify=t=>{var n,o;(o=(n=this.options).onChange)==null||o.call(n,this,t)},this.maybeNotify=ee(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),t=>{this.notify(t)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(t=>t()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var t;const n=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==n){if(this.cleanup(),!n){this.maybeNotify();return}this.scrollElement=n,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((t=this.scrollElement)==null?void 0:t.window)??null,this.elementsCache.forEach(o=>{this.observer.observe(o)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,o=>{this.scrollRect=o,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(o,r)=>{this.scrollAdjustments=0,this.scrollDirection=r?this.getScrollOffset()<o?"forward":"backward":null,this.scrollOffset=o,this.isScrolling=r,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(t,n)=>{const o=new Map,r=new Map;for(let s=n-1;s>=0;s--){const i=t[s];if(o.has(i.lane))continue;const a=r.get(i.lane);if(a==null||i.end>a.end?r.set(i.lane,i):i.end<a.end&&o.set(i.lane,!0),o.size===this.options.lanes)break}return r.size===this.options.lanes?Array.from(r.values()).sort((s,i)=>s.end===i.end?s.index-i.index:s.end-i.end)[0]:void 0},this.getMeasurementOptions=ee(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(t,n,o,r,s)=>(this.pendingMeasuredCacheIndexes=[],{count:t,paddingStart:n,scrollMargin:o,getItemKey:r,enabled:s}),{key:!1}),this.getMeasurements=ee(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:t,paddingStart:n,scrollMargin:o,getItemKey:r,enabled:s},i)=>{if(!s)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(d=>{this.itemSizeCache.set(d.key,d.size)}));const a=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const u=this.measurementsCache.slice(0,a);for(let d=a;d<t;d++){const m=r(d),S=this.options.lanes===1?u[d-1]:this.getFurthestMeasurement(u,d),c=S?S.end+this.options.gap:n+o,O=i.get(m),x=typeof O=="number"?O:this.options.estimateSize(d),b=c+x,P=S?S.lane:d%this.options.lanes;u[d]={index:d,start:c,size:x,end:b,key:m,lane:P}}return this.measurementsCache=u,u},{key:!1,debug:()=>this.options.debug}),this.calculateRange=ee(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(t,n,o,r)=>this.range=t.length>0&&n>0?Mt({measurements:t,outerSize:n,scrollOffset:o,lanes:r}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=ee(()=>{let t=null,n=null;const o=this.calculateRange();return o&&(t=o.startIndex,n=o.endIndex),this.maybeNotify.updateDeps([this.isScrolling,t,n]),[this.options.rangeExtractor,this.options.overscan,this.options.count,t,n]},(t,n,o,r,s)=>r===null||s===null?[]:t({startIndex:r,endIndex:s,overscan:n,count:o}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=t=>{const n=this.options.indexAttribute,o=t.getAttribute(n);return o?parseInt(o,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(t,n)=>{const o=this.indexFromElement(t),r=this.measurementsCache[o];if(!r)return;const s=r.key,i=this.elementsCache.get(s);i!==t&&(i&&this.observer.unobserve(i),this.observer.observe(t),this.elementsCache.set(s,t)),t.isConnected&&this.resizeItem(o,this.options.measureElement(t,n,this))},this.resizeItem=(t,n)=>{const o=this.measurementsCache[t];if(!o)return;const r=this.itemSizeCache.get(o.key)??o.size,s=n-r;s!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(o,s,this):o.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=s,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(o.index),this.itemSizeCache=new Map(this.itemSizeCache.set(o.key,n)),this.notify(!1))},this.measureElement=t=>{if(!t){this.elementsCache.forEach((n,o)=>{n.isConnected||(this.observer.unobserve(n),this.elementsCache.delete(o))});return}this._measureElement(t,void 0)},this.getVirtualItems=ee(()=>[this.getVirtualIndexes(),this.getMeasurements()],(t,n)=>{const o=[];for(let r=0,s=t.length;r<s;r++){const i=t[r],a=n[i];o.push(a)}return o},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=t=>{const n=this.getMeasurements();if(n.length!==0)return pe(n[ze(0,n.length-1,o=>pe(n[o]).start,t)])},this.getOffsetForAlignment=(t,n,o=0)=>{const r=this.getSize(),s=this.getScrollOffset();n==="auto"&&(n=t>=s+r?"end":"start"),n==="center"?t+=(o-r)/2:n==="end"&&(t-=r);const i=this.options.horizontal?"scrollWidth":"scrollHeight",u=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[i]:this.scrollElement[i]:0)-r;return Math.max(Math.min(u,t),0)},this.getOffsetForIndex=(t,n="auto")=>{t=Math.max(0,Math.min(t,this.options.count-1));const o=this.measurementsCache[t];if(!o)return;const r=this.getSize(),s=this.getScrollOffset();if(n==="auto")if(o.end>=s+r-this.options.scrollPaddingEnd)n="end";else if(o.start<=s+this.options.scrollPaddingStart)n="start";else return[s,n];const i=n==="end"?o.end+this.options.scrollPaddingEnd:o.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(i,n,o.size),n]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(t,{align:n="start",behavior:o}={})=>{this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(t,n),{adjustments:void 0,behavior:o})},this.scrollToIndex=(t,{align:n="auto",behavior:o}={})=>{t=Math.max(0,Math.min(t,this.options.count-1)),this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const r=this.getOffsetForIndex(t,n);if(!r)return;const[s,i]=r;this._scrollToOffset(s,{adjustments:void 0,behavior:o}),o!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(t))){const[u]=pe(this.getOffsetForIndex(t,i));xt(u,this.getScrollOffset())||this.scrollToIndex(t,{align:i,behavior:o})}else this.scrollToIndex(t,{align:i,behavior:o})}))},this.scrollBy=(t,{behavior:n}={})=>{this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+t,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var t;const n=this.getMeasurements();let o;if(n.length===0)o=this.options.paddingStart;else if(this.options.lanes===1)o=((t=n[n.length-1])==null?void 0:t.end)??0;else{const r=Array(this.options.lanes).fill(null);let s=n.length-1;for(;s>=0&&r.some(i=>i===null);){const i=n[s];r[i.lane]===null&&(r[i.lane]=i.end),s--}o=Math.max(...r.filter(i=>i!==null))}return Math.max(o-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(t,{adjustments:n,behavior:o})=>{this.options.scrollToFn(t,{behavior:o,adjustments:n},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(l)}}const ze=(e,l,t,n)=>{for(;e<=l;){const o=(e+l)/2|0,r=t(o);if(r<n)e=o+1;else if(r>n)l=o-1;else return o}return e>0?e-1:0};function Mt({measurements:e,outerSize:l,scrollOffset:t,lanes:n}){const o=e.length-1,r=a=>e[a].start;if(e.length<=n)return{startIndex:0,endIndex:o};let s=ze(0,o,r,t),i=s;if(n===1)for(;i<o&&e[i].end<t+l;)i++;else if(n>1){const a=Array(n).fill(0);for(;i<o&&a.some(d=>d<t+l);){const d=e[i];a[d.lane]=d.end,i++}const u=Array(n).fill(t+l);for(;s>=0&&u.some(d=>d>=t);){const d=e[s];u[d.lane]=d.start,s--}s=Math.max(0,s-s%n),i=Math.min(o,i+(n-1-i%n))}return{startIndex:s,endIndex:i}}const Me=typeof document<"u"?f.useLayoutEffect:f.useEffect;function wt(e){const l=f.useReducer(()=>({}),{})[1],t={...e,onChange:(o,r)=>{var s;r?Y.flushSync(l):l(),(s=e.onChange)==null||s.call(e,o,r)}},[n]=f.useState(()=>new Rt(t));return n.setOptions(t),Me(()=>n._didMount(),[]),Me(()=>n._willUpdate()),n}function $t(e){return wt({observeElementRect:It,observeElementOffset:yt,scrollToFn:Tt,...e})}function _e(e){let l=f.useRef({value:"",selectionStart:null,selectionEnd:null});return vt(e,"blur",t=>{let n=t.target;n instanceof HTMLInputElement&&(l.current={value:n.value,selectionStart:n.selectionStart,selectionEnd:n.selectionEnd})}),E(()=>{if(document.activeElement!==e&&e instanceof HTMLInputElement&&e.isConnected){if(e.focus({preventScroll:!0}),e.value!==l.current.value)e.setSelectionRange(e.value.length,e.value.length);else{let{selectionStart:t,selectionEnd:n}=l.current;t!==null&&n!==null&&e.setSelectionRange(t,n)}l.current={value:"",selectionStart:null,selectionEnd:null}}})}var be=(e=>(e[e.Left=0]="Left",e[e.Right=2]="Right",e))(be||{}),Pt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Pt||{}),zt=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(zt||{}),_t=(e=>(e[e.Pointer=0]="Pointer",e[e.Focus=1]="Focus",e[e.Other=2]="Other",e))(_t||{}),Dt=(e=>(e[e.OpenCombobox=0]="OpenCombobox",e[e.CloseCombobox=1]="CloseCombobox",e[e.GoToOption=2]="GoToOption",e[e.SetTyping=3]="SetTyping",e[e.RegisterOption=4]="RegisterOption",e[e.UnregisterOption=5]="UnregisterOption",e[e.SetActivationTrigger=6]="SetActivationTrigger",e[e.UpdateVirtualConfiguration=7]="UpdateVirtualConfiguration",e[e.SetInputElement=8]="SetInputElement",e[e.SetButtonElement=9]="SetButtonElement",e[e.SetOptionsElement=10]="SetOptionsElement",e))(Dt||{});function me(e,l=t=>t){let t=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,n=l(e.options.slice()),o=n.length>0&&n[0].dataRef.current.order!==null?n.sort((s,i)=>s.dataRef.current.order-i.dataRef.current.order):dt(n,s=>s.dataRef.current.domRef.current),r=t?o.indexOf(t):null;return r===-1&&(r=null),{options:o,activeOptionIndex:r}}let Ft={1(e){var l;return(l=e.dataRef.current)!=null&&l.disabled||e.comboboxState===1?e:{...e,activeOptionIndex:null,comboboxState:1,isTyping:!1,activationTrigger:2,__demoMode:!1}},0(e){var l,t;if((l=e.dataRef.current)!=null&&l.disabled||e.comboboxState===0)return e;if((t=e.dataRef.current)!=null&&t.value){let n=e.dataRef.current.calculateIndex(e.dataRef.current.value);if(n!==-1)return{...e,activeOptionIndex:n,comboboxState:0,__demoMode:!1}}return{...e,comboboxState:0,__demoMode:!1}},3(e,l){return e.isTyping===l.isTyping?e:{...e,isTyping:l.isTyping}},2(e,l){var t,n,o,r;if((t=e.dataRef.current)!=null&&t.disabled||e.optionsElement&&!((n=e.dataRef.current)!=null&&n.optionsPropsRef.current.static)&&e.comboboxState===1)return e;if(e.virtual){let{options:u,disabled:d}=e.virtual,m=l.focus===w.Specific?l.idx:Oe(l,{resolveItems:()=>u,resolveActiveIndex:()=>{var c,O;return(O=(c=e.activeOptionIndex)!=null?c:u.findIndex(x=>!d(x)))!=null?O:null},resolveDisabled:d,resolveId(){throw new Error("Function not implemented.")}}),S=(o=l.trigger)!=null?o:2;return e.activeOptionIndex===m&&e.activationTrigger===S?e:{...e,activeOptionIndex:m,activationTrigger:S,isTyping:!1,__demoMode:!1}}let s=me(e);if(s.activeOptionIndex===null){let u=s.options.findIndex(d=>!d.dataRef.current.disabled);u!==-1&&(s.activeOptionIndex=u)}let i=l.focus===w.Specific?l.idx:Oe(l,{resolveItems:()=>s.options,resolveActiveIndex:()=>s.activeOptionIndex,resolveId:u=>u.id,resolveDisabled:u=>u.dataRef.current.disabled}),a=(r=l.trigger)!=null?r:2;return e.activeOptionIndex===i&&e.activationTrigger===a?e:{...e,...s,isTyping:!1,activeOptionIndex:i,activationTrigger:a,__demoMode:!1}},4:(e,l)=>{var t,n,o;if((t=e.dataRef.current)!=null&&t.virtual)return{...e,options:[...e.options,l.payload]};let r=l.payload,s=me(e,a=>(a.push(r),a));e.activeOptionIndex===null&&(n=e.dataRef.current)!=null&&n.isSelected(l.payload.dataRef.current.value)&&(s.activeOptionIndex=s.options.indexOf(r));let i={...e,...s,activationTrigger:2};return(o=e.dataRef.current)!=null&&o.__demoMode&&e.dataRef.current.value===void 0&&(i.activeOptionIndex=0),i},5:(e,l)=>{var t;if((t=e.dataRef.current)!=null&&t.virtual)return{...e,options:e.options.filter(o=>o.id!==l.id)};let n=me(e,o=>{let r=o.findIndex(s=>s.id===l.id);return r!==-1&&o.splice(r,1),o});return{...e,...n,activationTrigger:2}},6:(e,l)=>e.activationTrigger===l.trigger?e:{...e,activationTrigger:l.trigger},7:(e,l)=>{var t,n;if(e.virtual===null)return{...e,virtual:{options:l.options,disabled:(t=l.disabled)!=null?t:()=>!1}};if(e.virtual.options===l.options&&e.virtual.disabled===l.disabled)return e;let o=e.activeOptionIndex;if(e.activeOptionIndex!==null){let r=l.options.indexOf(e.virtual.options[e.activeOptionIndex]);r!==-1?o=r:o=null}return{...e,activeOptionIndex:o,virtual:{options:l.options,disabled:(n=l.disabled)!=null?n:()=>!1}}},8:(e,l)=>e.inputElement===l.element?e:{...e,inputElement:l.element},9:(e,l)=>e.buttonElement===l.element?e:{...e,buttonElement:l.element},10:(e,l)=>e.optionsElement===l.element?e:{...e,optionsElement:l.element}},ve=f.createContext(null);ve.displayName="ComboboxActionsContext";function ae(e){let l=f.useContext(ve);if(l===null){let t=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ae),t}return l}let De=f.createContext(null);function At(e){let l=ne("VirtualProvider"),{options:t}=l.virtual,[n,o]=f.useMemo(()=>{let u=l.optionsElement;if(!u)return[0,0];let d=window.getComputedStyle(u);return[parseFloat(d.paddingBlockStart||d.paddingTop),parseFloat(d.paddingBlockEnd||d.paddingBottom)]},[l.optionsElement]),r=$t({enabled:t.length!==0,scrollPaddingStart:n,scrollPaddingEnd:o,count:t.length,estimateSize(){return 40},getScrollElement(){return l.optionsElement},overscan:12}),[s,i]=f.useState(0);Q(()=>{i(u=>u+1)},[t]);let a=r.getVirtualItems();return a.length===0?null:k.createElement(De.Provider,{value:r},k.createElement("div",{style:{position:"relative",width:"100%",height:`${r.getTotalSize()}px`},ref:u=>{u&&l.activationTrigger!==0&&l.activeOptionIndex!==null&&t.length>l.activeOptionIndex&&r.scrollToIndex(l.activeOptionIndex)}},a.map(u=>{var d;return k.createElement(f.Fragment,{key:u.key},k.cloneElement((d=e.children)==null?void 0:d.call(e,{...e.slot,option:t[u.index]}),{key:`${s}-${u.key}`,"data-index":u.index,"aria-setsize":t.length,"aria-posinset":u.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${u.start}px)`,overflowAnchor:"none"}}))})))}let se=f.createContext(null);se.displayName="ComboboxDataContext";function ne(e){let l=f.useContext(se);if(l===null){let t=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ne),t}return l}function kt(e,l){return te(l.type,Ft,e,l)}let Lt=f.Fragment;function Bt(e,l){var t,n;let o=lt(),{value:r,defaultValue:s,onChange:i,form:a,name:u,by:d,disabled:m=o||!1,onClose:S,__demoMode:c=!1,multiple:O=!1,immediate:x=!1,virtual:b=null,nullable:P,...T}=e,$=mt(s),[R=O?[]:void 0,_]=ht(r,i,$),[y,g]=f.useReducer(kt,{dataRef:f.createRef(),comboboxState:c?0:1,isTyping:!1,options:[],virtual:b?{options:b.options,disabled:(t=b.disabled)!=null?t:()=>!1}:null,activeOptionIndex:null,activationTrigger:2,inputElement:null,buttonElement:null,optionsElement:null,__demoMode:c}),D=f.useRef(!1),U=f.useRef({static:!1,hold:!1}),B=ft(d),K=E(h=>b?d===null?b.options.indexOf(h):b.options.findIndex(I=>B(I,h)):y.options.findIndex(I=>B(I.dataRef.current.value,h))),G=f.useCallback(h=>te(v.mode,{1:()=>R.some(I=>B(I,h)),0:()=>B(R,h)}),[R]),H=E(h=>y.activeOptionIndex===K(h)),v=f.useMemo(()=>({...y,immediate:x,optionsPropsRef:U,value:R,defaultValue:$,disabled:m,mode:O?1:0,virtual:b?y.virtual:null,get activeOptionIndex(){if(D.current&&y.activeOptionIndex===null&&(b?b.options.length>0:y.options.length>0)){if(b){let I=b.options.findIndex(W=>{var ue,ge;return!((ge=(ue=b.disabled)==null?void 0:ue.call(b,W))!=null&&ge)});if(I!==-1)return I}let h=y.options.findIndex(I=>!I.dataRef.current.disabled);if(h!==-1)return h}return y.activeOptionIndex},calculateIndex:K,compare:B,isSelected:G,isActive:H}),[R,$,m,O,c,y,b]);Q(()=>{var h;b&&g({type:7,options:b.options,disabled:(h=b.disabled)!=null?h:null})},[b,b==null?void 0:b.options,b==null?void 0:b.disabled]),Q(()=>{y.dataRef.current=v},[v]);let C=v.comboboxState===0;rt(C,[v.buttonElement,v.inputElement,v.optionsElement],()=>A.closeCombobox());let j=f.useMemo(()=>{var h,I,W;return{open:v.comboboxState===0,disabled:m,activeIndex:v.activeOptionIndex,activeOption:v.activeOptionIndex===null?null:v.virtual?v.virtual.options[(h=v.activeOptionIndex)!=null?h:0]:(W=(I=v.options[v.activeOptionIndex])==null?void 0:I.dataRef.current.value)!=null?W:null,value:R}},[v,m,R]),q=E(()=>{if(v.activeOptionIndex!==null){if(A.setIsTyping(!1),v.virtual)p(v.virtual.options[v.activeOptionIndex]);else{let{dataRef:h}=v.options[v.activeOptionIndex];p(h.current.value)}A.goToOption(w.Specific,v.activeOptionIndex)}}),J=E(()=>{g({type:0}),D.current=!0}),Z=E(()=>{g({type:1}),D.current=!1,S==null||S()}),oe=E(h=>{g({type:3,isTyping:h})}),ie=E((h,I,W)=>(D.current=!1,h===w.Specific?g({type:2,focus:w.Specific,idx:I,trigger:W}):g({type:2,focus:h,trigger:W}))),F=E((h,I)=>(g({type:4,payload:{id:h,dataRef:I}}),()=>{v.isActive(I.current.value)&&(D.current=!0),g({type:5,id:h})})),p=E(h=>te(v.mode,{0(){return _==null?void 0:_(h)},1(){let I=v.value.slice(),W=I.findIndex(ue=>B(ue,h));return W===-1?I.push(h):I.splice(W,1),_==null?void 0:_(I)}})),V=E(h=>{g({type:6,trigger:h})}),z=E(h=>{g({type:8,element:h})}),N=E(h=>{g({type:9,element:h})}),M=E(h=>{g({type:10,element:h})}),A=f.useMemo(()=>({onChange:p,registerOption:F,goToOption:ie,setIsTyping:oe,closeCombobox:Z,openCombobox:J,setActivationTrigger:V,selectActiveOption:q,setInputElement:z,setButtonElement:N,setOptionsElement:M}),[]),[X,Fe]=at(),Ae=l===null?{}:{ref:l},ke=f.useCallback(()=>{if($!==void 0)return _==null?void 0:_($)},[_,$]),Le=re();return k.createElement(Fe,{value:X,props:{htmlFor:(n=v.inputElement)==null?void 0:n.id},slot:{open:v.comboboxState===0,disabled:m}},k.createElement(ut,null,k.createElement(ve.Provider,{value:A},k.createElement(se.Provider,{value:v},k.createElement(ct,{value:te(v.comboboxState,{0:ce.Open,1:ce.Closed})},u!=null&&k.createElement(bt,{disabled:m,data:R!=null?{[u]:R}:{},form:a,onReset:ke}),Le({ourProps:Ae,theirProps:T,slot:j,defaultTag:Lt,name:"Combobox"}))))))}let Vt="input";function Nt(e,l){var t,n,o,r,s;let i=ne("Combobox.Input"),a=ae("Combobox.Input"),u=f.useId(),d=Ve(),{id:m=d||`headlessui-combobox-input-${u}`,onChange:S,displayValue:c,disabled:O=i.disabled||!1,autoFocus:x=!1,type:b="text",...P}=e,T=f.useRef(null),$=de(T,l,Ne(),a.setInputElement),R=we(i.inputElement),_=je(),y=E(()=>{a.onChange(null),i.optionsElement&&(i.optionsElement.scrollTop=0),a.goToOption(w.Nothing)}),g=f.useMemo(()=>{var p;return typeof c=="function"&&i.value!==void 0?(p=c(i.value))!=null?p:"":typeof i.value=="string"?i.value:""},[i.value,c]);ye(([p,V],[z,N])=>{if(i.isTyping)return;let M=T.current;M&&((N===0&&V===1||p!==z)&&(M.value=p),requestAnimationFrame(()=>{if(i.isTyping||!M||(R==null?void 0:R.activeElement)!==M)return;let{selectionStart:A,selectionEnd:X}=M;Math.abs((X??0)-(A??0))===0&&A===0&&M.setSelectionRange(M.value.length,M.value.length)}))},[g,i.comboboxState,R,i.isTyping]),ye(([p],[V])=>{if(p===0&&V===1){if(i.isTyping)return;let z=T.current;if(!z)return;let N=z.value,{selectionStart:M,selectionEnd:A,selectionDirection:X}=z;z.value="",z.value=N,X!==null?z.setSelectionRange(M,A,X):z.setSelectionRange(M,A)}},[i.comboboxState]);let D=f.useRef(!1),U=E(()=>{D.current=!0}),B=E(()=>{_.nextFrame(()=>{D.current=!1})}),K=E(p=>{switch(a.setIsTyping(!0),p.key){case L.Enter:if(i.comboboxState!==0||D.current)return;if(p.preventDefault(),p.stopPropagation(),i.activeOptionIndex===null){a.closeCombobox();return}a.selectActiveOption(),i.mode===0&&a.closeCombobox();break;case L.ArrowDown:return p.preventDefault(),p.stopPropagation(),te(i.comboboxState,{0:()=>a.goToOption(w.Next),1:()=>a.openCombobox()});case L.ArrowUp:return p.preventDefault(),p.stopPropagation(),te(i.comboboxState,{0:()=>a.goToOption(w.Previous),1:()=>{Y.flushSync(()=>a.openCombobox()),i.value||a.goToOption(w.Last)}});case L.Home:if(p.shiftKey)break;return p.preventDefault(),p.stopPropagation(),a.goToOption(w.First);case L.PageUp:return p.preventDefault(),p.stopPropagation(),a.goToOption(w.First);case L.End:if(p.shiftKey)break;return p.preventDefault(),p.stopPropagation(),a.goToOption(w.Last);case L.PageDown:return p.preventDefault(),p.stopPropagation(),a.goToOption(w.Last);case L.Escape:return i.comboboxState!==0?void 0:(p.preventDefault(),i.optionsElement&&!i.optionsPropsRef.current.static&&p.stopPropagation(),i.mode===0&&i.value===null&&y(),a.closeCombobox());case L.Tab:if(i.comboboxState!==0)return;i.mode===0&&i.activationTrigger!==1&&a.selectActiveOption(),a.closeCombobox();break}}),G=E(p=>{S==null||S(p),i.mode===0&&p.target.value===""&&y(),a.openCombobox()}),H=E(p=>{var V,z,N;let M=(V=p.relatedTarget)!=null?V:Ce.find(A=>A!==p.currentTarget);if(!((z=i.optionsElement)!=null&&z.contains(M))&&!((N=i.buttonElement)!=null&&N.contains(M))&&i.comboboxState===0)return p.preventDefault(),i.mode===0&&i.value===null&&y(),a.closeCombobox()}),v=E(p=>{var V,z,N;let M=(V=p.relatedTarget)!=null?V:Ce.find(A=>A!==p.currentTarget);(z=i.buttonElement)!=null&&z.contains(M)||(N=i.optionsElement)!=null&&N.contains(M)||i.disabled||i.immediate&&i.comboboxState!==0&&_.microTask(()=>{Y.flushSync(()=>a.openCombobox()),a.setActivationTrigger(1)})}),C=he(),j=We(),{isFocused:q,focusProps:J}=$e({autoFocus:x}),{isHovered:Z,hoverProps:oe}=Pe({isDisabled:O}),ie=f.useMemo(()=>({open:i.comboboxState===0,disabled:O,hover:Z,focus:q,autofocus:x}),[i,Z,q,x,O]),F=fe({ref:$,id:m,role:"combobox",type:b,"aria-controls":(t=i.optionsElement)==null?void 0:t.id,"aria-expanded":i.comboboxState===0,"aria-activedescendant":i.activeOptionIndex===null?void 0:i.virtual?(n=i.options.find(p=>!p.dataRef.current.disabled&&i.compare(p.dataRef.current.value,i.virtual.options[i.activeOptionIndex])))==null?void 0:n.id:(o=i.options[i.activeOptionIndex])==null?void 0:o.id,"aria-labelledby":C,"aria-describedby":j,"aria-autocomplete":"list",defaultValue:(s=(r=e.defaultValue)!=null?r:i.defaultValue!==void 0?c==null?void 0:c(i.defaultValue):null)!=null?s:i.defaultValue,disabled:O||void 0,autoFocus:x,onCompositionStart:U,onCompositionEnd:B,onKeyDown:K,onChange:G,onFocus:v,onBlur:H},J,oe);return re()({ourProps:F,theirProps:P,slot:ie,defaultTag:Vt,name:"Combobox.Input"})}let jt="button";function Wt(e,l){var t;let n=ne("Combobox.Button"),o=ae("Combobox.Button"),r=de(l,o.setButtonElement),s=f.useId(),{id:i=`headlessui-combobox-button-${s}`,disabled:a=n.disabled||!1,autoFocus:u=!1,...d}=e,m=_e(n.inputElement),S=E(g=>{switch(g.key){case L.Space:case L.Enter:g.preventDefault(),g.stopPropagation(),n.comboboxState===1&&Y.flushSync(()=>o.openCombobox()),m();return;case L.ArrowDown:g.preventDefault(),g.stopPropagation(),n.comboboxState===1&&(Y.flushSync(()=>o.openCombobox()),n.value||o.goToOption(w.First)),m();return;case L.ArrowUp:g.preventDefault(),g.stopPropagation(),n.comboboxState===1&&(Y.flushSync(()=>o.openCombobox()),n.value||o.goToOption(w.Last)),m();return;case L.Escape:if(n.comboboxState!==0)return;g.preventDefault(),n.optionsElement&&!n.optionsPropsRef.current.static&&g.stopPropagation(),Y.flushSync(()=>o.closeCombobox()),m();return;default:return}}),c=E(g=>{g.preventDefault(),!Ue(g.currentTarget)&&(g.button===be.Left&&(n.comboboxState===0?o.closeCombobox():o.openCombobox()),m())}),O=he([i]),{isFocusVisible:x,focusProps:b}=$e({autoFocus:u}),{isHovered:P,hoverProps:T}=Pe({isDisabled:a}),{pressed:$,pressProps:R}=Ke({disabled:a}),_=f.useMemo(()=>({open:n.comboboxState===0,active:$||n.comboboxState===0,disabled:a,value:n.value,hover:P,focus:x}),[n,P,x,$,a]),y=fe({ref:r,id:i,type:He(e,n.buttonElement),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(t=n.optionsElement)==null?void 0:t.id,"aria-expanded":n.comboboxState===0,"aria-labelledby":O,disabled:a||void 0,autoFocus:u,onMouseDown:c,onKeyDown:S},b,T,R);return re()({ourProps:y,theirProps:d,slot:_,defaultTag:jt,name:"Combobox.Button"})}let Ut="div",Kt=Se.RenderStrategy|Se.Static;function Ht(e,l){var t,n,o;let r=f.useId(),{id:s=`headlessui-combobox-options-${r}`,hold:i=!1,anchor:a,portal:u=!1,modal:d=!0,transition:m=!1,...S}=e,c=ne("Combobox.Options"),O=ae("Combobox.Options"),x=Ge(a);x&&(u=!0);let[b,P]=qe(x),[T,$]=f.useState(null),R=Qe(),_=de(l,x?b:null,O.setOptionsElement,$),y=we(c.optionsElement),g=Je(),[D,U]=Xe(m,T,g!==null?(g&ce.Open)===ce.Open:c.comboboxState===0);Ye(D,c.inputElement,O.closeCombobox);let B=c.__demoMode?!1:d&&c.comboboxState===0;Ze(B,y);let K=c.__demoMode?!1:d&&c.comboboxState===0;et(K,{allowed:f.useCallback(()=>[c.inputElement,c.buttonElement,c.optionsElement],[c.inputElement,c.buttonElement,c.optionsElement])}),Q(()=>{var F;c.optionsPropsRef.current.static=(F=e.static)!=null?F:!1},[c.optionsPropsRef,e.static]),Q(()=>{c.optionsPropsRef.current.hold=i},[c.optionsPropsRef,i]),gt(c.comboboxState===0,{container:c.optionsElement,accept(F){return F.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:F.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(F){F.setAttribute("role","none")}});let G=he([(t=c.buttonElement)==null?void 0:t.id]),H=f.useMemo(()=>({open:c.comboboxState===0,option:void 0}),[c.comboboxState]),v=E(()=>{O.setActivationTrigger(0)}),C=E(F=>{F.preventDefault(),O.setActivationTrigger(0)}),j=fe(x?R():{},{"aria-labelledby":G,role:"listbox","aria-multiselectable":c.mode===1?!0:void 0,id:s,ref:_,style:{...S.style,...P,"--input-width":xe(c.inputElement,!0).width,"--button-width":xe(c.buttonElement,!0).width},onWheel:c.activationTrigger===0?void 0:v,onMouseDown:C,...tt(U)}),q=D&&c.comboboxState===1,J=Ie(q,(n=c.virtual)==null?void 0:n.options),Z=Ie(q,c.value),oe=E(F=>c.compare(Z,F));if(c.virtual){if(J===void 0)throw new Error("Missing `options` in virtual mode");Object.assign(S,{children:k.createElement(se.Provider,{value:J!==c.virtual.options?{...c,virtual:{...c.virtual,options:J}}:c},k.createElement(At,{slot:H},S.children))})}let ie=re();return k.createElement(nt,{enabled:u?e.static||D:!1},k.createElement(se.Provider,{value:c.mode===1?c:{...c,isSelected:oe}},ie({ourProps:j,theirProps:{...S,children:k.createElement(pt,{freeze:q},typeof S.children=="function"?(o=S.children)==null?void 0:o.call(S,H):S.children)},slot:H,defaultTag:Ut,features:Kt,visible:D,name:"Combobox.Options"})))}let Gt="div";function qt(e,l){var t,n,o,r;let s=ne("Combobox.Option"),i=ae("Combobox.Option"),a=f.useId(),{id:u=`headlessui-combobox-option-${a}`,value:d,disabled:m=(o=(n=(t=s.virtual)==null?void 0:t.disabled)==null?void 0:n.call(t,d))!=null?o:!1,order:S=null,...c}=e,O=_e(s.inputElement),x=s.virtual?s.activeOptionIndex===s.calculateIndex(d):s.activeOptionIndex===null?!1:((r=s.options[s.activeOptionIndex])==null?void 0:r.id)===u,b=s.isSelected(d),P=f.useRef(null),T=ot({disabled:m,value:d,domRef:P,order:S}),$=f.useContext(De),R=de(l,P,$?$.measureElement:null),_=E(()=>{i.setIsTyping(!1),i.onChange(d)});Q(()=>i.registerOption(u,T),[T,u]);let y=f.useRef(!(s.virtual||s.__demoMode));Q(()=>{if(!s.virtual&&!s.__demoMode)return Ee().requestAnimationFrame(()=>{y.current=!0})},[s.virtual,s.__demoMode]),Q(()=>{if(y.current&&s.comboboxState===0&&x&&s.activationTrigger!==0)return Ee().requestAnimationFrame(()=>{var C,j;(j=(C=P.current)==null?void 0:C.scrollIntoView)==null||j.call(C,{block:"nearest"})})},[P,x,s.comboboxState,s.activationTrigger,s.activeOptionIndex]);let g=E(C=>{C.preventDefault(),C.button===be.Left&&(m||(_(),it()||requestAnimationFrame(()=>O()),s.mode===0&&i.closeCombobox()))}),D=E(()=>{if(m)return i.goToOption(w.Nothing);let C=s.calculateIndex(d);i.goToOption(w.Specific,C)}),U=st(),B=E(C=>U.update(C)),K=E(C=>{if(!U.wasMoved(C)||m||x)return;let j=s.calculateIndex(d);i.goToOption(w.Specific,j,0)}),G=E(C=>{U.wasMoved(C)&&(m||x&&(s.optionsPropsRef.current.hold||i.goToOption(w.Nothing)))}),H=f.useMemo(()=>({active:x,focus:x,selected:b,disabled:m}),[x,b,m]),v={id:u,ref:R,role:"option",tabIndex:m===!0?void 0:-1,"aria-disabled":m===!0?!0:void 0,"aria-selected":b,disabled:void 0,onMouseDown:g,onFocus:D,onPointerEnter:B,onMouseEnter:B,onPointerMove:K,onMouseMove:K,onPointerLeave:G,onMouseLeave:G};return re()({ourProps:v,theirProps:c,slot:H,defaultTag:Gt,name:"Combobox.Option"})}let Qt=le(Bt),Jt=le(Wt),Xt=le(Nt),Yt=Be,Zt=le(Ht),en=le(qt),rn=Object.assign(Qt,{Input:Xt,Button:Jt,Label:Yt,Options:Zt,Option:en});export{Xt as G,rn as H,Zt as K,Jt as U,en as j};
