import{u as A,n as H,a as i,w,x as U,j as e,B as G,k as o,C as _,y as L,z as $,D as h,E as O,G as W,H as J,l}from"./index-C7NFS0Jj.js";import{u as K,a as Q,b as X,g as Y,h as Z,i as ee,j as S,k as te,l as se,m as le,n as ne,C as re,c as ae,F as oe,f as u,T as ie,d as de,S as ce,e as ge,P as ue}from"./columns-C7ky8JfL.js";import{P as xe}from"./Page-BXPe8LrY.js";import{T as me}from"./Toolbar-BxSs9RM5.js";import{g as be}from"./getUserAgentBrowser-DtA_zdP4.js";const fe=be()==="Safari";function pe({pageName:x,doctype:c,fields:we,addNewRoute:j="add-new",storageKey:m="default",isPrint:R=!1,data:b=[],info:g=null,search:d={doctype:c,page:1,page_length:10,fields:null},setSearch:y=()=>{},onDeleteRow:C=()=>{},onDeleteRows:k=()=>{}}){const{cardSkin:F}=A(),P=H(),[N,f]=K(),[n,v]=i.useState({enableSorting:!0,enableColumnFilters:!0,enableFullScreen:!1,enableRowDense:!1}),[T,M]=i.useState(""),[I,z]=i.useState([]),[D,V]=w(`column-visibility-${m}`,{}),[E,q]=w(`column-pinning-${m}`,{}),p=i.useRef(),{width:B}=Q({ref:p}),r=X({data:b,columns:re(g==null?void 0:g.fields,[],R),doctype:c,state:{globalFilter:T,sorting:I,columnVisibility:D,columnPinning:E,tableSettings:n},meta:{setTableSettings:v,deleteRow:s=>{f(),C(s)},deleteRows:s=>{f(),k(s)}},filterFns:{fuzzy:S},enableSorting:n.enableSorting,enableColumnFilters:n.enableColumnFilters,getCoreRowModel:ne(),onGlobalFilterChange:M,getFilteredRowModel:le(),getFacetedUniqueValues:se(),getFacetedMinMaxValues:te(),globalFilterFn:S,onSortingChange:z,getSortedRowModel:ee(),getExpandedRowModel:Z(),getRowCanExpand:()=>!0,getPaginationRowModel:Y(),onColumnVisibilityChange:V,onColumnPinningChange:q,autoResetPageIndex:N});return U(()=>r.resetRowSelection(),[b]),ae(n.enableFullScreen),e.jsx(xe,{title:x,children:e.jsxs("div",{className:"transition-content grid grid-cols-1 grid-rows-[auto_auto_1fr] px-(--margin-x) py-4",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[e.jsx("div",{className:"min-w-0",children:e.jsx("h2",{className:"truncate text-lg font-medium text-gray-800 dark:text-dark-50",children:x})}),e.jsxs(G,{className:"h-7 space-x-1 rounded-md px-2 text-xs",color:"primary",onClick:()=>P(j),children:[e.jsx(oe,{className:"size-4"}),e.jsxs("span",{children:["New ",c]})]})]}),e.jsxs("div",{className:o("flex flex-col pt-2",n.enableFullScreen&&"fixed inset-0 z-61 h-full w-full bg-white pt-2 dark:bg-dark-900"),children:[e.jsx(me,{table:r}),e.jsxs(_,{className:o("relative mt-2 flex grow flex-col",n.enableFullScreen&&"overflow-hidden"),ref:p,children:[e.jsx("div",{className:"table-wrapper min-w-full grow overflow-x-auto",children:e.jsxs(L,{hoverable:!0,dense:n.enableRowDense,sticky:n.enableFullScreen,className:"w-full text-left rtl:text-right",children:[e.jsx($,{children:r.getHeaderGroups().map(s=>e.jsx(h,{children:s.headers.map(t=>e.jsxs(O,{className:o("bg-gray-200 font-bold text-xs uppercase text-gray-800 dark:bg-dark-800 dark:text-dark-100 first:ltr:rounded-tl-lg last:ltr:rounded-tr-lg first:rtl:rounded-tr-lg last:rtl:rounded-tl-lg px-3 py-3 max-w-xs",t.column.getCanPin()&&[t.column.getIsPinned()==="left"&&"sticky z-2 ltr:left-0 rtl:right-0",t.column.getIsPinned()==="right"&&"sticky z-2 ltr:right-0 rtl:left-0"]),children:[t.column.getCanSort()?e.jsxs("div",{className:"flex cursor-pointer select-none items-center space-x-2",onClick:t.column.getToggleSortingHandler(),children:[e.jsx("span",{className:"flex-1 text-xs font-bold truncate",children:t.isPlaceholder?null:(()=>{const a=u(t.column.columnDef.header,t.getContext());return typeof a=="string"&&a.length>15?a.substring(0,15)+"...":a})()}),e.jsx(ie,{sorted:t.column.getIsSorted()})]}):t.isPlaceholder?null:e.jsx("span",{className:"text-xs font-bold truncate",children:(()=>{const a=u(t.column.columnDef.header,t.getContext());return typeof a=="string"&&a.length>15?a.substring(0,15)+"...":a})()}),t.column.getCanFilter()?e.jsx(de,{column:t.column}):null]},t.id))},s.id))}),e.jsx(W,{children:r.getRowModel().rows.map(s=>e.jsxs(i.Fragment,{children:[e.jsx(h,{className:o("relative border-y border-transparent border-b-gray-200 dark:border-b-dark-500",s.getIsExpanded()&&"border-dashed",s.getIsSelected()&&!fe&&"row-selected after:pointer-events-none after:absolute after:inset-0 after:z-2 after:h-full after:w-full after:border-3 after:border-transparent after:bg-primary-500/10 ltr:after:border-l-primary-500 rtl:after:border-r-primary-500"),children:s.getVisibleCells().map(t=>e.jsxs(J,{className:o("relative text-xs px-2 py-1",t.column.id==="actions"?"overflow-visible":"truncate max-w-xs",F==="shadow-sm"?"dark:bg-dark-700":"dark:bg-dark-900",t.column.getCanPin()&&[t.column.getIsPinned()==="left"&&"sticky z-2 ltr:left-0 rtl:right-0",t.column.getIsPinned()==="right"&&"sticky z-2 ltr:right-0 rtl:left-0"]),children:[t.column.getIsPinned()&&e.jsx("div",{className:o("pointer-events-none absolute inset-0 border-gray-200 dark:border-dark-500",t.column.getIsPinned()==="left"?"ltr:border-r rtl:border-l":"ltr:border-l rtl:border-r")}),u(t.column.columnDef.cell,t.getContext())]},t.id))}),s.getIsExpanded()&&e.jsx("tr",{children:e.jsx("td",{colSpan:s.getVisibleCells().length,className:"p-0",children:e.jsx(ce,{row:s,cardWidth:B})})})]},s.id))})]})}),e.jsx(ge,{table:r}),r.getCoreRowModel().rows.length>0&&e.jsx("div",{className:o("px-2 pb-2 sm:px-3 sm:pt-2",n.enableFullScreen&&"bg-gray-50 dark:bg-dark-800",!(r.getIsSomeRowsSelected()||r.getIsAllRowsSelected())&&"pt-2"),children:e.jsx(ue,{table:r,count:(d==null?void 0:d.counts)??0,search:d,setSearch:y})})]})]})]})})}pe.propTypes={pageName:l.string.isRequired,doctype:l.string.isRequired,fields:l.arrayOf(l.string).isRequired,addNewRoute:l.string,storageKey:l.string,isPrint:l.bool,data:l.array,info:l.object,search:l.object,setSearch:l.func,onDeleteRow:l.func,onDeleteRows:l.func};export{pe as D};
