import{K as z,y as W,o as E,a as Ie,n as ie,$ as xe,d as we,w as Ce,e as Fe,_ as le,L as ee,x as Te,R as ke,f as Be,v as Me,u as be,g as Pe,i as j,m as Re,h as Oe,a5 as J,l as L,q as Se,s as _e,ad as De,t as Ne,ag as Le,ah as ce,Y as me,ac as Ae,E as Ke,M as Ge,J as He,N as U,O as te,T as Je,r as Ee,b as H,H as Ue,I as Ye,aa as ae}from"./transition-3IbKDl88.js";import{a as r,R as v}from"./index-C3Z12zyc.js";import{E as Qe}from"./active-element-history-Cr5of0y_.js";import{u as $e,b as Ze,R as qe,O as ye,C as Ve,a as A}from"./dialog-DsGTZLqw.js";import{f as ue,s as se}from"./frozen-Bu_NFhHJ.js";var We=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(We||{}),je=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(je||{});let ze={0:e=>({...e,popoverState:U(e.popoverState,{0:1,1:0}),__demoMode:!1}),1(e){return e.popoverState===1?e:{...e,popoverState:1,__demoMode:!1}},2(e,a){return e.button===a.button?e:{...e,button:a.button}},3(e,a){return e.buttonId===a.buttonId?e:{...e,buttonId:a.buttonId}},4(e,a){return e.panel===a.panel?e:{...e,panel:a.panel}},5(e,a){return e.panelId===a.panelId?e:{...e,panelId:a.panelId}}},pe=r.createContext(null);pe.displayName="PopoverContext";function ne(e){let a=r.useContext(pe);if(a===null){let p=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(p,ne),p}return a}let re=r.createContext(null);re.displayName="PopoverAPIContext";function de(e){let a=r.useContext(re);if(a===null){let p=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(p,de),p}return a}let fe=r.createContext(null);fe.displayName="PopoverGroupContext";function ge(){return r.useContext(fe)}let oe=r.createContext(null);oe.displayName="PopoverPanelContext";function Xe(){return r.useContext(oe)}function et(e,a){return U(a.type,ze,e,a)}let tt="div";function nt(e,a){var p;let{__demoMode:x=!1,...m}=e,g=r.useRef(null),w=W(a,Le(u=>{g.current=u})),o=r.useRef([]),f=r.useReducer(et,{__demoMode:x,popoverState:x?0:1,buttons:o,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:r.createRef(),afterPanelSentinel:r.createRef(),afterButtonSentinel:r.createRef()}),[{popoverState:h,button:n,buttonId:b,panel:d,panelId:$,beforePanelSentinel:y,afterPanelSentinel:P,afterButtonSentinel:l},c]=f,S=ie((p=g.current)!=null?p:n),B=r.useMemo(()=>{if(!n||!d)return!1;for(let I of document.querySelectorAll("body > *"))if(Number(I==null?void 0:I.contains(n))^Number(I==null?void 0:I.contains(d)))return!0;let u=ce(),t=u.indexOf(n),i=(t+u.length-1)%u.length,s=(t+1)%u.length,F=u[i],k=u[s];return!d.contains(F)&&!d.contains(k)},[n,d]),M=me(b),R=me($),Y=r.useMemo(()=>({buttonId:M,panelId:R,close:()=>c({type:1})}),[M,R,c]),O=ge(),C=O==null?void 0:O.registerPopover,K=E(()=>{var u;return(u=O==null?void 0:O.isFocusWithinPopoverGroup())!=null?u:(S==null?void 0:S.activeElement)&&((n==null?void 0:n.contains(S.activeElement))||(d==null?void 0:d.contains(S.activeElement)))});r.useEffect(()=>C==null?void 0:C(Y),[C,Y]);let[T,Q]=Ae(),G=Ze(n),_=qe({mainTreeNode:G,portals:T,defaultContainers:[n,d]});Qe(S==null?void 0:S.defaultView,"focus",u=>{var t,i,s,F,k,I;u.target!==window&&u.target instanceof HTMLElement&&h===0&&(K()||n&&d&&(_.contains(u.target)||(i=(t=y.current)==null?void 0:t.contains)!=null&&i.call(t,u.target)||(F=(s=P.current)==null?void 0:s.contains)!=null&&F.call(s,u.target)||(I=(k=l.current)==null?void 0:k.contains)!=null&&I.call(k,u.target)||c({type:1})))},!0),Ke(h===0,_.resolveContainers,(u,t)=>{c({type:1}),Ue(t,Ye.Loose)||(u.preventDefault(),n==null||n.focus())});let D=E(u=>{c({type:1});let t=u?u instanceof HTMLElement?u:"current"in u&&u.current instanceof HTMLElement?u.current:n:n;t==null||t.focus()}),Z=r.useMemo(()=>({close:D,isPortalled:B}),[D,B]),q=r.useMemo(()=>({open:h===0,close:D}),[h,D]),V={ref:w},X=ee();return v.createElement(ye,{node:G},v.createElement(Ge,null,v.createElement(oe.Provider,{value:null},v.createElement(pe.Provider,{value:f},v.createElement(re.Provider,{value:Z},v.createElement(Ve,{value:D},v.createElement(He,{value:U(h,{0:j.Open,1:j.Closed})},v.createElement(Q,null,X({ourProps:V,theirProps:m,slot:q,defaultTag:tt,name:"Popover"})))))))))}let rt="button";function ot(e,a){let p=r.useId(),{id:x=`headlessui-popover-button-${p}`,disabled:m=!1,autoFocus:g=!1,...w}=e,[o,f]=ne("Popover.Button"),{isPortalled:h}=de("Popover.Button"),n=r.useRef(null),b=`headlessui-focus-sentinel-${r.useId()}`,d=ge(),$=d==null?void 0:d.closeOthers,y=Xe()!==null;r.useEffect(()=>{if(!y)return f({type:3,buttonId:x}),()=>{f({type:3,buttonId:null})}},[y,x,f]);let[P]=r.useState(()=>Symbol()),l=W(n,a,Ie(),E(t=>{if(!y){if(t)o.buttons.current.push(P);else{let i=o.buttons.current.indexOf(P);i!==-1&&o.buttons.current.splice(i,1)}o.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),t&&f({type:2,button:t})}})),c=W(n,a),S=ie(n),B=E(t=>{var i,s,F;if(y){if(o.popoverState===1)return;switch(t.key){case H.Space:case H.Enter:t.preventDefault(),(s=(i=t.target).click)==null||s.call(i),f({type:1}),(F=o.button)==null||F.focus();break}}else switch(t.key){case H.Space:case H.Enter:t.preventDefault(),t.stopPropagation(),o.popoverState===1&&($==null||$(o.buttonId)),f({type:0});break;case H.Escape:if(o.popoverState!==0)return $==null?void 0:$(o.buttonId);if(!n.current||S!=null&&S.activeElement&&!n.current.contains(S.activeElement))return;t.preventDefault(),t.stopPropagation(),f({type:1});break}}),M=E(t=>{y||t.key===H.Space&&t.preventDefault()}),R=E(t=>{var i,s;Ee(t.currentTarget)||m||(y?(f({type:1}),(i=o.button)==null||i.focus()):(t.preventDefault(),t.stopPropagation(),o.popoverState===1&&($==null||$(o.buttonId)),f({type:0}),(s=o.button)==null||s.focus()))}),Y=E(t=>{t.preventDefault(),t.stopPropagation()}),{isFocusVisible:O,focusProps:C}=xe({autoFocus:g}),{isHovered:K,hoverProps:T}=we({isDisabled:m}),{pressed:Q,pressProps:G}=Ce({disabled:m}),_=o.popoverState===0,D=r.useMemo(()=>({open:_,active:Q||_,disabled:m,hover:K,focus:O,autofocus:g}),[_,K,O,Q,m,g]),Z=Fe(e,o.button),q=y?le({ref:c,type:Z,onKeyDown:B,onClick:R,disabled:m||void 0,autoFocus:g},C,T,G):le({ref:l,id:o.buttonId,type:Z,"aria-expanded":o.popoverState===0,"aria-controls":o.panel?o.panelId:void 0,disabled:m||void 0,autoFocus:g,onKeyDown:B,onKeyUp:M,onClick:R,onMouseDown:Y},C,T,G),V=$e(),X=E(()=>{let t=o.panel;if(!t)return;function i(){U(V.current,{[A.Forwards]:()=>J(t,L.First),[A.Backwards]:()=>J(t,L.Last)})===ae.Error&&J(ce().filter(s=>s.dataset.headlessuiFocusGuard!=="true"),U(V.current,{[A.Forwards]:L.Next,[A.Backwards]:L.Previous}),{relativeTo:o.button})}i()}),u=ee();return v.createElement(v.Fragment,null,u({ourProps:q,theirProps:w,slot:D,defaultTag:rt,name:"Popover.Button"}),_&&!y&&h&&v.createElement(ue,{id:b,ref:o.afterButtonSentinel,features:se.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:X}))}let lt="div",at=te.RenderStrategy|te.Static;function he(e,a){let p=r.useId(),{id:x=`headlessui-popover-backdrop-${p}`,transition:m=!1,...g}=e,[{popoverState:w},o]=ne("Popover.Backdrop"),[f,h]=r.useState(null),n=W(a,h),b=be(),[d,$]=Pe(m,f,b!==null?(b&j.Open)===j.Open:w===0),y=E(c=>{if(Ee(c.currentTarget))return c.preventDefault();o({type:1})}),P=r.useMemo(()=>({open:w===0}),[w]),l={ref:n,id:x,"aria-hidden":!0,onClick:y,...Se($)};return ee()({ourProps:l,theirProps:g,slot:P,defaultTag:lt,features:at,visible:d,name:"Popover.Backdrop"})}let ut="div",st=te.RenderStrategy|te.Static;function it(e,a){let p=r.useId(),{id:x=`headlessui-popover-panel-${p}`,focus:m=!1,anchor:g,portal:w=!1,modal:o=!1,transition:f=!1,...h}=e,[n,b]=ne("Popover.Panel"),{close:d,isPortalled:$}=de("Popover.Panel"),y=`headlessui-focus-sentinel-before-${p}`,P=`headlessui-focus-sentinel-after-${p}`,l=r.useRef(null),c=Te(g),[S,B]=ke(c),M=Be();c&&(w=!0);let[R,Y]=r.useState(null),O=W(l,a,c?S:null,E(t=>b({type:4,panel:t})),Y),C=ie(l);Me(()=>(b({type:5,panelId:x}),()=>{b({type:5,panelId:null})}),[x,b]);let K=be(),[T,Q]=Pe(f,R,K!==null?(K&j.Open)===j.Open:n.popoverState===0);Re(T,n.button,()=>{b({type:1})});let G=n.__demoMode?!1:o&&T;Oe(G,C);let _=E(t=>{var i;switch(t.key){case H.Escape:if(n.popoverState!==0||!l.current||C!=null&&C.activeElement&&!l.current.contains(C.activeElement))return;t.preventDefault(),t.stopPropagation(),b({type:1}),(i=n.button)==null||i.focus();break}});r.useEffect(()=>{var t;e.static||n.popoverState===1&&((t=e.unmount)==null||t)&&b({type:4,panel:null})},[n.popoverState,e.unmount,e.static,b]),r.useEffect(()=>{if(n.__demoMode||!m||n.popoverState!==0||!l.current)return;let t=C==null?void 0:C.activeElement;l.current.contains(t)||J(l.current,L.First)},[n.__demoMode,m,l.current,n.popoverState]);let D=r.useMemo(()=>({open:n.popoverState===0,close:d}),[n.popoverState,d]),Z=le(c?M():{},{ref:O,id:x,onKeyDown:_,onBlur:m&&n.popoverState===0?t=>{var i,s,F,k,I;let N=t.relatedTarget;N&&l.current&&((i=l.current)!=null&&i.contains(N)||(b({type:1}),((F=(s=n.beforePanelSentinel.current)==null?void 0:s.contains)!=null&&F.call(s,N)||(I=(k=n.afterPanelSentinel.current)==null?void 0:k.contains)!=null&&I.call(k,N))&&N.focus({preventScroll:!0})))}:void 0,tabIndex:-1,style:{...h.style,...B,"--button-width":_e(n.button,!0).width},...Se(Q)}),q=$e(),V=E(()=>{let t=l.current;if(!t)return;function i(){U(q.current,{[A.Forwards]:()=>{var s;J(t,L.First)===ae.Error&&((s=n.afterPanelSentinel.current)==null||s.focus())},[A.Backwards]:()=>{var s;(s=n.button)==null||s.focus({preventScroll:!0})}})}i()}),X=E(()=>{let t=l.current;if(!t)return;function i(){U(q.current,{[A.Forwards]:()=>{if(!n.button)return;let s=ce(),F=s.indexOf(n.button),k=s.slice(0,F+1),I=[...s.slice(F+1),...k];for(let N of I.slice())if(N.dataset.headlessuiFocusGuard==="true"||R!=null&&R.contains(N)){let ve=I.indexOf(N);ve!==-1&&I.splice(ve,1)}J(I,L.First,{sorted:!1})},[A.Backwards]:()=>{var s;J(t,L.Previous)===ae.Error&&((s=n.button)==null||s.focus())}})}i()}),u=ee();return v.createElement(De,null,v.createElement(oe.Provider,{value:x},v.createElement(re.Provider,{value:{close:d,isPortalled:$}},v.createElement(Ne,{enabled:w?e.static||T:!1},T&&$&&v.createElement(ue,{id:y,ref:n.beforePanelSentinel,features:se.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:V}),u({ourProps:Z,theirProps:h,slot:D,defaultTag:ut,features:st,visible:T,name:"Popover.Panel"}),T&&$&&v.createElement(ue,{id:P,ref:n.afterPanelSentinel,features:se.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:X})))))}let ct="div";function pt(e,a){let p=r.useRef(null),x=W(p,a),[m,g]=r.useState([]),w=E(P=>{g(l=>{let c=l.indexOf(P);if(c!==-1){let S=l.slice();return S.splice(c,1),S}return l})}),o=E(P=>(g(l=>[...l,P]),()=>w(P))),f=E(()=>{var P;let l=Je(p);if(!l)return!1;let c=l.activeElement;return(P=p.current)!=null&&P.contains(c)?!0:m.some(S=>{var B,M;return((B=l.getElementById(S.buttonId.current))==null?void 0:B.contains(c))||((M=l.getElementById(S.panelId.current))==null?void 0:M.contains(c))})}),h=E(P=>{for(let l of m)l.buttonId.current!==P&&l.close()}),n=r.useMemo(()=>({registerPopover:o,unregisterPopover:w,isFocusWithinPopoverGroup:f,closeOthers:h}),[o,w,f,h]),b=r.useMemo(()=>({}),[]),d=e,$={ref:x},y=ee();return v.createElement(ye,null,v.createElement(fe.Provider,{value:n},y({ourProps:$,theirProps:d,slot:b,defaultTag:ct,name:"Popover.Group"})))}let dt=z(nt),ft=z(ot),vt=z(he),mt=z(he),bt=z(it),Pt=z(pt),ht=Object.assign(dt,{Button:ft,Backdrop:mt,Overlay:vt,Panel:bt,Group:Pt});export{bt as R,ft as S,ht as l};
